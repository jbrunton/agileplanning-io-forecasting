<div class="row">
  <div class="large-12 columns">

    <h1>Forecast</h1>

  </div>
</div>
<div class="row">

  <div class="large-4 columns">

    <%= form_tag do  %>
        <div class="row">
          <div class="larger-12 columns">
            <label>Start date
              <input type="text" name="start_date" id="start_date" value="<%= @start_date ? @start_date.to_s : nil %>" />
            </label>
          </div>
        </div>

        <div class="row">
          <div class="larger-12 columns">
            <label>Filter
              <input type="text" name="filter" id="filter" value="<%= params[:filter] ? params[:filter] : nil %>" />
            </label>
          </div>
        </div>

        <div class="row">
          <div class="large-12 columns">
            <%= submit_tag 'Forecast' %>
          </div>
        </div>
    <% end %>

    <h4>Backlog</h4>
    <% @backlog.each do |epic| %>
        <div class="panel"><%= epic.summary %></div>
    <% end %>

  </div>
  <div class="large-8 columns">

      <% if @forecasts %>
        <% @forecasts.each do |record| %>
            <h4><%= record[:epic].summary %></h4>

            <table style="width: 100%">
              <tr>
                <th>Likelihood</th>
                <th>Time</th>
              </tr>
              <% record[:forecast].each do |interval| %>
                  <tr>
                    <td><%= "#{interval[:likelihood]} %" %></td>
                    <td><%= "#{sprintf('%.1f', interval[:actual_time])} days" %></td>
                    <td><%= format_datetime(@start_date + interval[:actual_time].days) %></td>
                  </tr>
              <% end %>
            </table>

        <% end %>
      <% end %>
  </div>
</div>